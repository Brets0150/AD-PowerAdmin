**********************
Windows PowerShell transcript start
Start time: 20221112074756
Username: TDCME\bret.admin
RunAs User: TDCME\bret.admin
Machine: FL-222 (Microsoft Windows NT 10.0.14393.0)
Host Application: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
Process ID: 6416
PSVersion: 5.1.14393.5127
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.14393.5127
BuildVersion: 10.0.14393.5127
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************

    ______      __                 ________          ___
   / ____/_  __/ /_  ___  _____   / ____/ /___ _____/ (_)_  _______
  / /   / / / / __ \/ _ \/ ___/  / / __/ / __ `/ __  / / / / / ___/
 / /___/ /_/ / /_/ /  __/ /     / /_/ / / /_/ / /_/ / / /_/ (__  )
 \____/\__, /_.___/\___/_/      \____/_/\__,_/\__,_/_/\__,_/____/
      /____/   Presents
    ___    ____        ____                          ___       __          _
   /   |  / __ \      / __ \____ _      _____  _____/   | ____/ /___ ___  (_)___
  / /| | / / / /_____/ /_/ / __ \ | /| / / _ \/ ___/ /| |/ __  / __ `__ \/ / __ \
 / ___ |/ /_/ /_____/ ____/ /_/ / |/ |/ /  __/ /  / ___ / /_/ / / / / / / / / / /
/_/  |_/_____/     /_/    \____/|__/|__/\___/_/  /_/  |_\__,_/_/ /_/ /_/_/_/ /_/
Version: 0.6.0 beta
================ AD-PowerAdmin Tools ================
 1:  Press  '1' Audit AD Admin account Report.
 2:  Press  '2' Run a security audit.
 3:  Press  '3' Force KRBTGT password Update.
 4:  Press  '4' Search for inactive computers report only.
 5:  Press  '5' Search for inactive computers and disable them.
 6:  Press  '6' Search for inactive users accounts.
 7:  Press  '7' Search for inactive users accounts and disable them.
 8:  Press  '8' Run a password audit WITHOUT sending emails to users or scheduling a forced password changes.
 9:  Press  '9' Same as option 8, but send the password audit report to the Admins.
 10: Press  '10' Run a password audit AND send emails to users and schedule forced password changes.
D: Press 'D' Run all daily tasks.
I: Press 'I' To install this script as a scheduled task to run the daily test, checks, and clean-up.
E: Press 'E' To send a test email.
H: Press 'H' To show the help menu.
Q: Press 'Q' to quit.
**********************
Windows PowerShell transcript end
End time: 20221112074802
**********************
**********************
Windows PowerShell transcript start
Start time: 20221112074812
Username: TDCME\bret.admin
RunAs User: TDCME\bret.admin
Machine: FL-222 (Microsoft Windows NT 10.0.14393.0)
Host Application: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
Process ID: 6416
PSVersion: 5.1.14393.5127
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.14393.5127
BuildVersion: 10.0.14393.5127
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************

    ______      __                 ________          ___
   / ____/_  __/ /_  ___  _____   / ____/ /___ _____/ (_)_  _______
  / /   / / / / __ \/ _ \/ ___/  / / __/ / __ `/ __  / / / / / ___/
 / /___/ /_/ / /_/ /  __/ /     / /_/ / / /_/ / /_/ / / /_/ (__  )
 \____/\__, /_.___/\___/_/      \____/_/\__,_/\__,_/_/\__,_/____/
      /____/   Presents
    ___    ____        ____                          ___       __          _
   /   |  / __ \      / __ \____ _      _____  _____/   | ____/ /___ ___  (_)___
  / /| | / / / /_____/ /_/ / __ \ | /| / / _ \/ ___/ /| |/ __  / __ `__ \/ / __ \
 / ___ |/ /_/ /_____/ ____/ /_/ / |/ |/ /  __/ /  / ___ / /_/ / / / / / / / / / /
/_/  |_/_____/     /_/    \____/|__/|__/\___/_/  /_/  |_\__,_/_/ /_/ /_/_/_/ /_/
Version: 0.6.0 beta
================ AD-PowerAdmin Tools ================
 1:  Press  '1' Audit AD Admin account Report.
 2:  Press  '2' Run a security audit.
 3:  Press  '3' Force KRBTGT password Update.
 4:  Press  '4' Search for inactive computers report only.
 5:  Press  '5' Search for inactive computers and disable them.
 6:  Press  '6' Search for inactive users accounts.
 7:  Press  '7' Search for inactive users accounts and disable them.
 8:  Press  '8' Run a password audit WITHOUT sending emails to users or scheduling a forced password changes.
 9:  Press  '9' Same as option 8, but send the password audit report to the Admins.
 10: Press  '10' Run a password audit AND send emails to users and schedule forced password changes.
D: Press 'D' Run all daily tasks.
I: Press 'I' To install this script as a scheduled task to run the daily test, checks, and clean-up.
E: Press 'E' To send a test email.
H: Press 'H' To show the help menu.
Q: Press 'Q' to quit.
L:\Data\My Work\PowerShell Scripts\AD-PowerAdmin\AD-PowerAdmin.ps1
PS L:\Data\My Work\PowerShell Scripts\AD-PowerAdmin> TerminatingError(Get-ADServiceAccount): "Cannot find an object with identity: 'ADPowerAdmMSA$' under: 'DC=tdcme,DC=loc'."
Get-ADServiceAccount : Cannot find an object with identity: 'ADPowerAdmMSA$' under: 'DC=tdcme,DC=loc'.
At L:\Data\My Work\PowerShell Scripts\AD-PowerAdmin\AD-PowerAdmin.ps1:1201 char:13
+     $SID =  Get-ADServiceAccount -Identity "$global:MsaAccountName`$" ...
+             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (ADPowerAdmMSA$:ADServiceAccount) [Get-ADServiceAccount], 
ADIdentityNotFoundException
    + FullyQualifiedErrorId : ActiveDirectoryCmdlet:Microsoft.ActiveDirectory.Management.ADIdentityNotFoundException,Mic
rosoft.ActiveDirectory.Management.Commands.GetADServiceAccount
Get-ADServiceAccount : Cannot find an object with identity: 'ADPowerAdmMSA$' under: 'DC=tdcme,DC=loc'.
At L:\Data\My Work\PowerShell Scripts\AD-PowerAdmin\AD-PowerAdmin.ps1:1201 char:13
+     $SID =  Get-ADServiceAccount -Identity "$global:MsaAccountName`$" ...
+             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (ADPowerAdmMSA$:ADServiceAccount) [Get-ADServiceAccount], ADIdentityNotFoundException
    + FullyQualifiedErrorId : ActiveDirectoryCmdlet:Microsoft.ActiveDirectory.Management.ADIdentityNotFoundException,Microsoft.ActiveDirectory.Management.Commands.GetADServiceAcc
   ount

The GPO configuration file '\\tdcme.loc\SYSVOL\tdcme.loc\Policies\{6AC1786C-016F-11D2-945F-00C04fB984F9}\Machine\Microsoft\Windows NT\SecEdit\GptTmpl.inf' already contains the 'ADPowerAdmMSA' or '' line.

    ______      __                 ________          ___
   / ____/_  __/ /_  ___  _____   / ____/ /___ _____/ (_)_  _______
  / /   / / / / __ \/ _ \/ ___/  / / __/ / __ `/ __  / / / / / ___/
 / /___/ /_/ / /_/ /  __/ /     / /_/ / / /_/ / /_/ / / /_/ (__  )
 \____/\__, /_.___/\___/_/      \____/_/\__,_/\__,_/_/\__,_/____/
      /____/   Presents
    ___    ____        ____                          ___       __          _
   /   |  / __ \      / __ \____ _      _____  _____/   | ____/ /___ ___  (_)___
  / /| | / / / /_____/ /_/ / __ \ | /| / / _ \/ ___/ /| |/ __  / __ `__ \/ / __ \
 / ___ |/ /_/ /_____/ ____/ /_/ / |/ |/ /  __/ /  / ___ / /_/ / / / / / / / / / /
/_/  |_/_____/     /_/    \____/|__/|__/\___/_/  /_/  |_\__,_/_/ /_/ /_/_/_/ /_/
Version: 0.6.0 beta
================ AD-PowerAdmin Tools ================
 1:  Press  '1' Audit AD Admin account Report.
 2:  Press  '2' Run a security audit.
 3:  Press  '3' Force KRBTGT password Update.
 4:  Press  '4' Search for inactive computers report only.
 5:  Press  '5' Search for inactive computers and disable them.
 6:  Press  '6' Search for inactive users accounts.
 7:  Press  '7' Search for inactive users accounts and disable them.
 8:  Press  '8' Run a password audit WITHOUT sending emails to users or scheduling a forced password changes.
 9:  Press  '9' Same as option 8, but send the password audit report to the Admins.
 10: Press  '10' Run a password audit AND send emails to users and schedule forced password changes.
D: Press 'D' Run all daily tasks.
I: Press 'I' To install this script as a scheduled task to run the daily test, checks, and clean-up.
E: Press 'E' To send a test email.
H: Press 'H' To show the help menu.
Q: Press 'Q' to quit.
**********************
Windows PowerShell transcript end
End time: 20221112075055
**********************
**********************
Windows PowerShell transcript start
Start time: 20221112075104
Username: TDCME\bret.admin
RunAs User: TDCME\bret.admin
Machine: FL-222 (Microsoft Windows NT 10.0.14393.0)
Host Application: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
Process ID: 6416
PSVersion: 5.1.14393.5127
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.14393.5127
BuildVersion: 10.0.14393.5127
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************

    ______      __                 ________          ___
   / ____/_  __/ /_  ___  _____   / ____/ /___ _____/ (_)_  _______
  / /   / / / / __ \/ _ \/ ___/  / / __/ / __ `/ __  / / / / / ___/
 / /___/ /_/ / /_/ /  __/ /     / /_/ / / /_/ / /_/ / / /_/ (__  )
 \____/\__, /_.___/\___/_/      \____/_/\__,_/\__,_/_/\__,_/____/
      /____/   Presents
    ___    ____        ____                          ___       __          _
   /   |  / __ \      / __ \____ _      _____  _____/   | ____/ /___ ___  (_)___
  / /| | / / / /_____/ /_/ / __ \ | /| / / _ \/ ___/ /| |/ __  / __ `__ \/ / __ \
 / ___ |/ /_/ /_____/ ____/ /_/ / |/ |/ /  __/ /  / ___ / /_/ / / / / / / / / / /
/_/  |_/_____/     /_/    \____/|__/|__/\___/_/  /_/  |_\__,_/_/ /_/ /_/_/_/ /_/
Version: 0.6.0 beta
================ AD-PowerAdmin Tools ================
 1:  Press  '1' Audit AD Admin account Report.
 2:  Press  '2' Run a security audit.
 3:  Press  '3' Force KRBTGT password Update.
 4:  Press  '4' Search for inactive computers report only.
 5:  Press  '5' Search for inactive computers and disable them.
 6:  Press  '6' Search for inactive users accounts.
 7:  Press  '7' Search for inactive users accounts and disable them.
 8:  Press  '8' Run a password audit WITHOUT sending emails to users or scheduling a forced password changes.
 9:  Press  '9' Same as option 8, but send the password audit report to the Admins.
 10: Press  '10' Run a password audit AND send emails to users and schedule forced password changes.
D: Press 'D' Run all daily tasks.
I: Press 'I' To install this script as a scheduled task to run the daily test, checks, and clean-up.
E: Press 'E' To send a test email.
H: Press 'H' To show the help menu.
Q: Press 'Q' to quit.
L:\Data\My Work\PowerShell Scripts\AD-PowerAdmin\AD-PowerAdmin.ps1
PS L:\Data\My Work\PowerShell Scripts\AD-PowerAdmin> TerminatingError(Get-ADServiceAccount): "Cannot find an object with identity: 'ADPowerAdmMSA$' under: 'DC=tdcme,DC=loc'."
Get-ADServiceAccount : Cannot find an object with identity: 'ADPowerAdmMSA$' under: 'DC=tdcme,DC=loc'.
At L:\Data\My Work\PowerShell Scripts\AD-PowerAdmin\AD-PowerAdmin.ps1:1201 char:13
+     $SID =  Get-ADServiceAccount -Identity "$global:MsaAccountName`$" ...
+             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (ADPowerAdmMSA$:ADServiceAccount) [Get-ADServiceAccount], 
ADIdentityNotFoundException
    + FullyQualifiedErrorId : ActiveDirectoryCmdlet:Microsoft.ActiveDirectory.Management.ADIdentityNotFoundException,Mic
rosoft.ActiveDirectory.Management.Commands.GetADServiceAccount
Get-ADServiceAccount : Cannot find an object with identity: 'ADPowerAdmMSA$' under: 'DC=tdcme,DC=loc'.
At L:\Data\My Work\PowerShell Scripts\AD-PowerAdmin\AD-PowerAdmin.ps1:1201 char:13
+     $SID =  Get-ADServiceAccount -Identity "$global:MsaAccountName`$" ...
+             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (ADPowerAdmMSA$:ADServiceAccount) [Get-ADServiceAccount], ADIdentityNotFoundException
    + FullyQualifiedErrorId : ActiveDirectoryCmdlet:Microsoft.ActiveDirectory.Management.ADIdentityNotFoundException,Microsoft.ActiveDirectory.Management.Commands.GetADServiceAcc
   ount

Error: The SID for the sMSA account 'ADPowerAdmMSA' was not found.

    ______      __                 ________          ___
   / ____/_  __/ /_  ___  _____   / ____/ /___ _____/ (_)_  _______
  / /   / / / / __ \/ _ \/ ___/  / / __/ / __ `/ __  / / / / / ___/
 / /___/ /_/ / /_/ /  __/ /     / /_/ / / /_/ / /_/ / / /_/ (__  )
 \____/\__, /_.___/\___/_/      \____/_/\__,_/\__,_/_/\__,_/____/
      /____/   Presents
    ___    ____        ____                          ___       __          _
   /   |  / __ \      / __ \____ _      _____  _____/   | ____/ /___ ___  (_)___
  / /| | / / / /_____/ /_/ / __ \ | /| / / _ \/ ___/ /| |/ __  / __ `__ \/ / __ \
 / ___ |/ /_/ /_____/ ____/ /_/ / |/ |/ /  __/ /  / ___ / /_/ / / / / / / / / / /
/_/  |_/_____/     /_/    \____/|__/|__/\___/_/  /_/  |_\__,_/_/ /_/ /_/_/_/ /_/
Version: 0.6.0 beta
================ AD-PowerAdmin Tools ================
 1:  Press  '1' Audit AD Admin account Report.
 2:  Press  '2' Run a security audit.
 3:  Press  '3' Force KRBTGT password Update.
 4:  Press  '4' Search for inactive computers report only.
 5:  Press  '5' Search for inactive computers and disable them.
 6:  Press  '6' Search for inactive users accounts.
 7:  Press  '7' Search for inactive users accounts and disable them.
 8:  Press  '8' Run a password audit WITHOUT sending emails to users or scheduling a forced password changes.
 9:  Press  '9' Same as option 8, but send the password audit report to the Admins.
 10: Press  '10' Run a password audit AND send emails to users and schedule forced password changes.
D: Press 'D' Run all daily tasks.
I: Press 'I' To install this script as a scheduled task to run the daily test, checks, and clean-up.
E: Press 'E' To send a test email.
H: Press 'H' To show the help menu.
Q: Press 'Q' to quit.
**********************
Windows PowerShell transcript end
End time: 20221112075133
**********************
**********************
Windows PowerShell transcript start
Start time: 20221112075135
Username: TDCME\bret.admin
RunAs User: TDCME\bret.admin
Machine: FL-222 (Microsoft Windows NT 10.0.14393.0)
Host Application: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
Process ID: 6416
PSVersion: 5.1.14393.5127
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.14393.5127
BuildVersion: 10.0.14393.5127
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************

    ______      __                 ________          ___
   / ____/_  __/ /_  ___  _____   / ____/ /___ _____/ (_)_  _______
  / /   / / / / __ \/ _ \/ ___/  / / __/ / __ `/ __  / / / / / ___/
 / /___/ /_/ / /_/ /  __/ /     / /_/ / / /_/ / /_/ / / /_/ (__  )
 \____/\__, /_.___/\___/_/      \____/_/\__,_/\__,_/_/\__,_/____/
      /____/   Presents
    ___    ____        ____                          ___       __          _
   /   |  / __ \      / __ \____ _      _____  _____/   | ____/ /___ ___  (_)___
  / /| | / / / /_____/ /_/ / __ \ | /| / / _ \/ ___/ /| |/ __  / __ `__ \/ / __ \
 / ___ |/ /_/ /_____/ ____/ /_/ / |/ |/ /  __/ /  / ___ / /_/ / / / / / / / / / /
/_/  |_/_____/     /_/    \____/|__/|__/\___/_/  /_/  |_\__,_/_/ /_/ /_/_/_/ /_/
Version: 0.6.0 beta
================ AD-PowerAdmin Tools ================
 1:  Press  '1' Audit AD Admin account Report.
 2:  Press  '2' Run a security audit.
 3:  Press  '3' Force KRBTGT password Update.
 4:  Press  '4' Search for inactive computers report only.
 5:  Press  '5' Search for inactive computers and disable them.
 6:  Press  '6' Search for inactive users accounts.
 7:  Press  '7' Search for inactive users accounts and disable them.
 8:  Press  '8' Run a password audit WITHOUT sending emails to users or scheduling a forced password changes.
 9:  Press  '9' Same as option 8, but send the password audit report to the Admins.
 10: Press  '10' Run a password audit AND send emails to users and schedule forced password changes.
D: Press 'D' Run all daily tasks.
I: Press 'I' To install this script as a scheduled task to run the daily test, checks, and clean-up.
E: Press 'E' To send a test email.
H: Press 'H' To show the help menu.
Q: Press 'Q' to quit.
L:\Data\My Work\PowerShell Scripts\AD-PowerAdmin\AD-PowerAdmin.ps1
PS L:\Data\My Work\PowerShell Scripts\AD-PowerAdmin> TerminatingError(Get-ADServiceAccount): "Cannot find an object with identity: 'ADPowerAdmMSA$' under: 'DC=tdcme,DC=loc'."
Get-ADServiceAccount : Cannot find an object with identity: 'ADPowerAdmMSA$' under: 'DC=tdcme,DC=loc'.
At L:\Data\My Work\PowerShell Scripts\AD-PowerAdmin\AD-PowerAdmin.ps1:1201 char:13
+     $SID =  Get-ADServiceAccount -Identity "$global:MsaAccountName`$" ...
+             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (ADPowerAdmMSA$:ADServiceAccount) [Get-ADServiceAccount], 
ADIdentityNotFoundException
    + FullyQualifiedErrorId : ActiveDirectoryCmdlet:Microsoft.ActiveDirectory.Management.ADIdentityNotFoundException,Mic
rosoft.ActiveDirectory.Management.Commands.GetADServiceAccount
Get-ADServiceAccount : Cannot find an object with identity: 'ADPowerAdmMSA$' under: 'DC=tdcme,DC=loc'.
At L:\Data\My Work\PowerShell Scripts\AD-PowerAdmin\AD-PowerAdmin.ps1:1201 char:13
+     $SID =  Get-ADServiceAccount -Identity "$global:MsaAccountName`$" ...
+             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (ADPowerAdmMSA$:ADServiceAccount) [Get-ADServiceAccount], ADIdentityNotFoundException
    + FullyQualifiedErrorId : ActiveDirectoryCmdlet:Microsoft.ActiveDirectory.Management.ADIdentityNotFoundException,Microsoft.ActiveDirectory.Management.Commands.GetADServiceAcc
   ount

Error: The SID for the sMSA account 'ADPowerAdmMSA' was not found.

    ______      __                 ________          ___
   / ____/_  __/ /_  ___  _____   / ____/ /___ _____/ (_)_  _______
  / /   / / / / __ \/ _ \/ ___/  / / __/ / __ `/ __  / / / / / ___/
 / /___/ /_/ / /_/ /  __/ /     / /_/ / / /_/ / /_/ / / /_/ (__  )
 \____/\__, /_.___/\___/_/      \____/_/\__,_/\__,_/_/\__,_/____/
      /____/   Presents
    ___    ____        ____                          ___       __          _
   /   |  / __ \      / __ \____ _      _____  _____/   | ____/ /___ ___  (_)___
  / /| | / / / /_____/ /_/ / __ \ | /| / / _ \/ ___/ /| |/ __  / __ `__ \/ / __ \
 / ___ |/ /_/ /_____/ ____/ /_/ / |/ |/ /  __/ /  / ___ / /_/ / / / / / / / / / /
/_/  |_/_____/     /_/    \____/|__/|__/\___/_/  /_/  |_\__,_/_/ /_/ /_/_/_/ /_/
Version: 0.6.0 beta
================ AD-PowerAdmin Tools ================
 1:  Press  '1' Audit AD Admin account Report.
 2:  Press  '2' Run a security audit.
 3:  Press  '3' Force KRBTGT password Update.
 4:  Press  '4' Search for inactive computers report only.
 5:  Press  '5' Search for inactive computers and disable them.
 6:  Press  '6' Search for inactive users accounts.
 7:  Press  '7' Search for inactive users accounts and disable them.
 8:  Press  '8' Run a password audit WITHOUT sending emails to users or scheduling a forced password changes.
 9:  Press  '9' Same as option 8, but send the password audit report to the Admins.
 10: Press  '10' Run a password audit AND send emails to users and schedule forced password changes.
D: Press 'D' Run all daily tasks.
I: Press 'I' To install this script as a scheduled task to run the daily test, checks, and clean-up.
E: Press 'E' To send a test email.
H: Press 'H' To show the help menu.
Q: Press 'Q' to quit.
**********************
Windows PowerShell transcript end
End time: 20221112075153
**********************
**********************
Windows PowerShell transcript start
Start time: 20221112075238
Username: TDCME\bret.admin
RunAs User: TDCME\bret.admin
Machine: FL-222 (Microsoft Windows NT 10.0.14393.0)
Host Application: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
Process ID: 6416
PSVersion: 5.1.14393.5127
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.14393.5127
BuildVersion: 10.0.14393.5127
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************

    ______      __                 ________          ___
   / ____/_  __/ /_  ___  _____   / ____/ /___ _____/ (_)_  _______
  / /   / / / / __ \/ _ \/ ___/  / / __/ / __ `/ __  / / / / / ___/
 / /___/ /_/ / /_/ /  __/ /     / /_/ / / /_/ / /_/ / / /_/ (__  )
 \____/\__, /_.___/\___/_/      \____/_/\__,_/\__,_/_/\__,_/____/
      /____/   Presents
    ___    ____        ____                          ___       __          _
   /   |  / __ \      / __ \____ _      _____  _____/   | ____/ /___ ___  (_)___
  / /| | / / / /_____/ /_/ / __ \ | /| / / _ \/ ___/ /| |/ __  / __ `__ \/ / __ \
 / ___ |/ /_/ /_____/ ____/ /_/ / |/ |/ /  __/ /  / ___ / /_/ / / / / / / / / / /
/_/  |_/_____/     /_/    \____/|__/|__/\___/_/  /_/  |_\__,_/_/ /_/ /_/_/_/ /_/
Version: 0.6.0 beta
================ AD-PowerAdmin Tools ================
 1:  Press  '1' Audit AD Admin account Report.
 2:  Press  '2' Run a security audit.
 3:  Press  '3' Force KRBTGT password Update.
 4:  Press  '4' Search for inactive computers report only.
 5:  Press  '5' Search for inactive computers and disable them.
 6:  Press  '6' Search for inactive users accounts.
 7:  Press  '7' Search for inactive users accounts and disable them.
 8:  Press  '8' Run a password audit WITHOUT sending emails to users or scheduling a forced password changes.
 9:  Press  '9' Same as option 8, but send the password audit report to the Admins.
 10: Press  '10' Run a password audit AND send emails to users and schedule forced password changes.
D: Press 'D' Run all daily tasks.
I: Press 'I' To install this script as a scheduled task to run the daily test, checks, and clean-up.
E: Press 'E' To send a test email.
H: Press 'H' To show the help menu.
Q: Press 'Q' to quit.
L:\Data\My Work\PowerShell Scripts\AD-PowerAdmin\AD-PowerAdmin.ps1
PS L:\Data\My Work\PowerShell Scripts\AD-PowerAdmin> TerminatingError(Get-ADServiceAccount): "Cannot find an object with identity: 'ADPowerAdmMSA$' under: 'DC=tdcme,DC=loc'."
Get-ADServiceAccount : Cannot find an object with identity: 'ADPowerAdmMSA$' under: 'DC=tdcme,DC=loc'.
At L:\Data\My Work\PowerShell Scripts\AD-PowerAdmin\AD-PowerAdmin.ps1:1201 char:12
+     $SID = Get-ADServiceAccount -Identity "$global:MsaAccountName`$"  ...
+            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (ADPowerAdmMSA$:ADServiceAccount) [Get-ADServiceAccount], 
ADIdentityNotFoundException
    + FullyQualifiedErrorId : ActiveDirectoryCmdlet:Microsoft.ActiveDirectory.Management.ADIdentityNotFoundException,Mic
rosoft.ActiveDirectory.Management.Commands.GetADServiceAccount
Get-ADServiceAccount : Cannot find an object with identity: 'ADPowerAdmMSA$' under: 'DC=tdcme,DC=loc'.
At L:\Data\My Work\PowerShell Scripts\AD-PowerAdmin\AD-PowerAdmin.ps1:1201 char:12
+     $SID = Get-ADServiceAccount -Identity "$global:MsaAccountName`$"  ...
+            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (ADPowerAdmMSA$:ADServiceAccount) [Get-ADServiceAccount], ADIdentityNotFoundException
    + FullyQualifiedErrorId : ActiveDirectoryCmdlet:Microsoft.ActiveDirectory.Management.ADIdentityNotFoundException,Microsoft.ActiveDirectory.Management.Commands.GetADServiceAcc
   ount

Error: The SID for the sMSA account 'ADPowerAdmMSA' was not found.

    ______      __                 ________          ___
   / ____/_  __/ /_  ___  _____   / ____/ /___ _____/ (_)_  _______
  / /   / / / / __ \/ _ \/ ___/  / / __/ / __ `/ __  / / / / / ___/
 / /___/ /_/ / /_/ /  __/ /     / /_/ / / /_/ / /_/ / / /_/ (__  )
 \____/\__, /_.___/\___/_/      \____/_/\__,_/\__,_/_/\__,_/____/
      /____/   Presents
    ___    ____        ____                          ___       __          _
   /   |  / __ \      / __ \____ _      _____  _____/   | ____/ /___ ___  (_)___
  / /| | / / / /_____/ /_/ / __ \ | /| / / _ \/ ___/ /| |/ __  / __ `__ \/ / __ \
 / ___ |/ /_/ /_____/ ____/ /_/ / |/ |/ /  __/ /  / ___ / /_/ / / / / / / / / / /
/_/  |_/_____/     /_/    \____/|__/|__/\___/_/  /_/  |_\__,_/_/ /_/ /_/_/_/ /_/
Version: 0.6.0 beta
================ AD-PowerAdmin Tools ================
 1:  Press  '1' Audit AD Admin account Report.
 2:  Press  '2' Run a security audit.
 3:  Press  '3' Force KRBTGT password Update.
 4:  Press  '4' Search for inactive computers report only.
 5:  Press  '5' Search for inactive computers and disable them.
 6:  Press  '6' Search for inactive users accounts.
 7:  Press  '7' Search for inactive users accounts and disable them.
 8:  Press  '8' Run a password audit WITHOUT sending emails to users or scheduling a forced password changes.
 9:  Press  '9' Same as option 8, but send the password audit report to the Admins.
 10: Press  '10' Run a password audit AND send emails to users and schedule forced password changes.
D: Press 'D' Run all daily tasks.
I: Press 'I' To install this script as a scheduled task to run the daily test, checks, and clean-up.
E: Press 'E' To send a test email.
H: Press 'H' To show the help menu.
Q: Press 'Q' to quit.
Error: The GPO configuration file '\\tdcme.loc\SYSVOL\tdcme.loc\Policies\{6AC1786C-016F-11D2-945F-00C04fB984F9}\Machine\Microsoft\Windows NT\SecEdit\GptTmpl.inf' was not updated.

    ______      __                 ________          ___
   / ____/_  __/ /_  ___  _____   / ____/ /___ _____/ (_)_  _______
  / /   / / / / __ \/ _ \/ ___/  / / __/ / __ `/ __  / / / / / ___/
 / /___/ /_/ / /_/ /  __/ /     / /_/ / / /_/ / /_/ / / /_/ (__  )
 \____/\__, /_.___/\___/_/      \____/_/\__,_/\__,_/_/\__,_/____/
      /____/   Presents
    ___    ____        ____                          ___       __          _
   /   |  / __ \      / __ \____ _      _____  _____/   | ____/ /___ ___  (_)___
  / /| | / / / /_____/ /_/ / __ \ | /| / / _ \/ ___/ /| |/ __  / __ `__ \/ / __ \
 / ___ |/ /_/ /_____/ ____/ /_/ / |/ |/ /  __/ /  / ___ / /_/ / / / / / / / / / /
/_/  |_/_____/     /_/    \____/|__/|__/\___/_/  /_/  |_\__,_/_/ /_/ /_/_/_/ /_/
Version: 0.6.0 beta
================ AD-PowerAdmin Tools ================
 1:  Press  '1' Audit AD Admin account Report.
 2:  Press  '2' Run a security audit.
 3:  Press  '3' Force KRBTGT password Update.
 4:  Press  '4' Search for inactive computers report only.
 5:  Press  '5' Search for inactive computers and disable them.
 6:  Press  '6' Search for inactive users accounts.
 7:  Press  '7' Search for inactive users accounts and disable them.
 8:  Press  '8' Run a password audit WITHOUT sending emails to users or scheduling a forced password changes.
 9:  Press  '9' Same as option 8, but send the password audit report to the Admins.
 10: Press  '10' Run a password audit AND send emails to users and schedule forced password changes.
D: Press 'D' Run all daily tasks.
I: Press 'I' To install this script as a scheduled task to run the daily test, checks, and clean-up.
E: Press 'E' To send a test email.
H: Press 'H' To show the help menu.
Q: Press 'Q' to quit.
**********************
Windows PowerShell transcript end
End time: 20221112075939
**********************
**********************
Windows PowerShell transcript start
Start time: 20221112082318
Username: TDCME\bret.admin
RunAs User: TDCME\bret.admin
Machine: FL-222 (Microsoft Windows NT 10.0.14393.0)
Host Application: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
Process ID: 6416
PSVersion: 5.1.14393.5127
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.14393.5127
BuildVersion: 10.0.14393.5127
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************

    ______      __                 ________          ___
   / ____/_  __/ /_  ___  _____   / ____/ /___ _____/ (_)_  _______
  / /   / / / / __ \/ _ \/ ___/  / / __/ / __ `/ __  / / / / / ___/
 / /___/ /_/ / /_/ /  __/ /     / /_/ / / /_/ / /_/ / / /_/ (__  )
 \____/\__, /_.___/\___/_/      \____/_/\__,_/\__,_/_/\__,_/____/
      /____/   Presents
    ___    ____        ____                          ___       __          _
   /   |  / __ \      / __ \____ _      _____  _____/   | ____/ /___ ___  (_)___
  / /| | / / / /_____/ /_/ / __ \ | /| / / _ \/ ___/ /| |/ __  / __ `__ \/ / __ \
 / ___ |/ /_/ /_____/ ____/ /_/ / |/ |/ /  __/ /  / ___ / /_/ / / / / / / / / / /
/_/  |_/_____/     /_/    \____/|__/|__/\___/_/  /_/  |_\__,_/_/ /_/ /_/_/_/ /_/
Version: 0.6.0 beta
================ AD-PowerAdmin Tools ================
 1:  Press  '1' Audit AD Admin account Report.
 2:  Press  '2' Run a security audit.
 3:  Press  '3' Force KRBTGT password Update.
 4:  Press  '4' Search for inactive computers report only.
 5:  Press  '5' Search for inactive computers and disable them.
 6:  Press  '6' Search for inactive users accounts.
 7:  Press  '7' Search for inactive users accounts and disable them.
 8:  Press  '8' Run a password audit WITHOUT sending emails to users or scheduling a forced password changes.
 9:  Press  '9' Same as option 8, but send the password audit report to the Admins.
 10: Press  '10' Run a password audit AND send emails to users and schedule forced password changes.
D: Press 'D' Run all daily tasks.
I: Press 'I' To install this script as a scheduled task to run the daily test, checks, and clean-up.
E: Press 'E' To send a test email.
H: Press 'H' To show the help menu.
Q: Press 'Q' to quit.
L:\Data\My Work\PowerShell Scripts\AD-PowerAdmin\AD-PowerAdmin.ps1
Error: The GPO configuration file '\\tdcme.loc\SYSVOL\tdcme.loc\Policies\{6AC1786C-016F-11D2-945F-00C04fB984F9}\Machine\Microsoft\Windows NT\SecEdit\GptTmpl.inf' does not contain the 'SeServiceLogonRight' line.

    ______      __                 ________          ___
   / ____/_  __/ /_  ___  _____   / ____/ /___ _____/ (_)_  _______
  / /   / / / / __ \/ _ \/ ___/  / / __/ / __ `/ __  / / / / / ___/
 / /___/ /_/ / /_/ /  __/ /     / /_/ / / /_/ / /_/ / / /_/ (__  )
 \____/\__, /_.___/\___/_/      \____/_/\__,_/\__,_/_/\__,_/____/
      /____/   Presents
    ___    ____        ____                          ___       __          _
   /   |  / __ \      / __ \____ _      _____  _____/   | ____/ /___ ___  (_)___
  / /| | / / / /_____/ /_/ / __ \ | /| / / _ \/ ___/ /| |/ __  / __ `__ \/ / __ \
 / ___ |/ /_/ /_____/ ____/ /_/ / |/ |/ /  __/ /  / ___ / /_/ / / / / / / / / / /
/_/  |_/_____/     /_/    \____/|__/|__/\___/_/  /_/  |_\__,_/_/ /_/ /_/_/_/ /_/
Version: 0.6.0 beta
================ AD-PowerAdmin Tools ================
 1:  Press  '1' Audit AD Admin account Report.
 2:  Press  '2' Run a security audit.
 3:  Press  '3' Force KRBTGT password Update.
 4:  Press  '4' Search for inactive computers report only.
 5:  Press  '5' Search for inactive computers and disable them.
 6:  Press  '6' Search for inactive users accounts.
 7:  Press  '7' Search for inactive users accounts and disable them.
 8:  Press  '8' Run a password audit WITHOUT sending emails to users or scheduling a forced password changes.
 9:  Press  '9' Same as option 8, but send the password audit report to the Admins.
 10: Press  '10' Run a password audit AND send emails to users and schedule forced password changes.
D: Press 'D' Run all daily tasks.
I: Press 'I' To install this script as a scheduled task to run the daily test, checks, and clean-up.
E: Press 'E' To send a test email.
H: Press 'H' To show the help menu.
Q: Press 'Q' to quit.
**********************
Windows PowerShell transcript end
End time: 20221112082411
**********************
**********************
Windows PowerShell transcript start
Start time: 20221112082414
Username: TDCME\bret.admin
RunAs User: TDCME\bret.admin
Machine: FL-222 (Microsoft Windows NT 10.0.14393.0)
Host Application: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
Process ID: 6416
PSVersion: 5.1.14393.5127
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.14393.5127
BuildVersion: 10.0.14393.5127
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************

    ______      __                 ________          ___
   / ____/_  __/ /_  ___  _____   / ____/ /___ _____/ (_)_  _______
  / /   / / / / __ \/ _ \/ ___/  / / __/ / __ `/ __  / / / / / ___/
 / /___/ /_/ / /_/ /  __/ /     / /_/ / / /_/ / /_/ / / /_/ (__  )
 \____/\__, /_.___/\___/_/      \____/_/\__,_/\__,_/_/\__,_/____/
      /____/   Presents
    ___    ____        ____                          ___       __          _
   /   |  / __ \      / __ \____ _      _____  _____/   | ____/ /___ ___  (_)___
  / /| | / / / /_____/ /_/ / __ \ | /| / / _ \/ ___/ /| |/ __  / __ `__ \/ / __ \
 / ___ |/ /_/ /_____/ ____/ /_/ / |/ |/ /  __/ /  / ___ / /_/ / / / / / / / / / /
/_/  |_/_____/     /_/    \____/|__/|__/\___/_/  /_/  |_\__,_/_/ /_/ /_/_/_/ /_/
Version: 0.6.0 beta
================ AD-PowerAdmin Tools ================
 1:  Press  '1' Audit AD Admin account Report.
 2:  Press  '2' Run a security audit.
 3:  Press  '3' Force KRBTGT password Update.
 4:  Press  '4' Search for inactive computers report only.
 5:  Press  '5' Search for inactive computers and disable them.
 6:  Press  '6' Search for inactive users accounts.
 7:  Press  '7' Search for inactive users accounts and disable them.
 8:  Press  '8' Run a password audit WITHOUT sending emails to users or scheduling a forced password changes.
 9:  Press  '9' Same as option 8, but send the password audit report to the Admins.
 10: Press  '10' Run a password audit AND send emails to users and schedule forced password changes.
D: Press 'D' Run all daily tasks.
I: Press 'I' To install this script as a scheduled task to run the daily test, checks, and clean-up.
E: Press 'E' To send a test email.
H: Press 'H' To show the help menu.
Q: Press 'Q' to quit.
L:\Data\My Work\PowerShell Scripts\AD-PowerAdmin\AD-PowerAdmin.ps1
Warrning: The GPO configuration file '\\tdcme.loc\SYSVOL\tdcme.loc\Policies\{6AC1786C-016F-11D2-945F-00C04fB984F9}\Machine\Microsoft\Windows NT\SecEdit\GptTmpl.inf' does not contain the 'SeServiceLogonRight' line.


DisplayName      : Default Domain Controllers Policy
DomainName       : tdcme.loc
Owner            : TDCME\Domain Admins
Id               : 6ac1786c-016f-11d2-945f-00c04fb984f9
GpoStatus        : AllSettingsEnabled
Description      :
CreationTime     : 3/7/2020 8:36:11 AM
ModificationTime : 11/12/2022 8:24:20 AM
UserVersion      : AD Version: 0, SysVol Version: 0
ComputerVersion  : AD Version: 20, SysVol Version: 20
WmiFilter        :

DisplayName      : Default Domain Controllers Policy
DomainName       : tdcme.loc
Owner            : TDCME\Domain Admins
Id               : 6ac1786c-016f-11d2-945f-00c04fb984f9
GpoStatus        : AllSettingsEnabled
Description      :
CreationTime     : 3/7/2020 8:36:11 AM
ModificationTime : 11/12/2022 8:24:20 AM
UserVersion      : AD Version: 0, SysVol Version: 0
ComputerVersion  : AD Version: 21, SysVol Version: 21
WmiFilter        :


    ______      __                 ________          ___
   / ____/_  __/ /_  ___  _____   / ____/ /___ _____/ (_)_  _______
  / /   / / / / __ \/ _ \/ ___/  / / __/ / __ `/ __  / / / / / ___/
 / /___/ /_/ / /_/ /  __/ /     / /_/ / / /_/ / /_/ / / /_/ (__  )
 \____/\__, /_.___/\___/_/      \____/_/\__,_/\__,_/_/\__,_/____/
      /____/   Presents
    ___    ____        ____                          ___       __          _
   /   |  / __ \      / __ \____ _      _____  _____/   | ____/ /___ ___  (_)___
  / /| | / / / /_____/ /_/ / __ \ | /| / / _ \/ ___/ /| |/ __  / __ `__ \/ / __ \
 / ___ |/ /_/ /_____/ ____/ /_/ / |/ |/ /  __/ /  / ___ / /_/ / / / / / / / / / /
/_/  |_/_____/     /_/    \____/|__/|__/\___/_/  /_/  |_\__,_/_/ /_/ /_/_/_/ /_/
Version: 0.6.0 beta
================ AD-PowerAdmin Tools ================
 1:  Press  '1' Audit AD Admin account Report.
 2:  Press  '2' Run a security audit.
 3:  Press  '3' Force KRBTGT password Update.
 4:  Press  '4' Search for inactive computers report only.
 5:  Press  '5' Search for inactive computers and disable them.
 6:  Press  '6' Search for inactive users accounts.
 7:  Press  '7' Search for inactive users accounts and disable them.
 8:  Press  '8' Run a password audit WITHOUT sending emails to users or scheduling a forced password changes.
 9:  Press  '9' Same as option 8, but send the password audit report to the Admins.
 10: Press  '10' Run a password audit AND send emails to users and schedule forced password changes.
D: Press 'D' Run all daily tasks.
I: Press 'I' To install this script as a scheduled task to run the daily test, checks, and clean-up.
E: Press 'E' To send a test email.
H: Press 'H' To show the help menu.
Q: Press 'Q' to quit.
**********************
Windows PowerShell transcript end
End time: 20221112083258
**********************
**********************
Windows PowerShell transcript start
Start time: 20221112083259
Username: TDCME\bret.admin
RunAs User: TDCME\bret.admin
Machine: FL-222 (Microsoft Windows NT 10.0.14393.0)
Host Application: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
Process ID: 6416
PSVersion: 5.1.14393.5127
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.14393.5127
BuildVersion: 10.0.14393.5127
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************

    ______      __                 ________          ___
   / ____/_  __/ /_  ___  _____   / ____/ /___ _____/ (_)_  _______
  / /   / / / / __ \/ _ \/ ___/  / / __/ / __ `/ __  / / / / / ___/
 / /___/ /_/ / /_/ /  __/ /     / /_/ / / /_/ / /_/ / / /_/ (__  )
 \____/\__, /_.___/\___/_/      \____/_/\__,_/\__,_/_/\__,_/____/
      /____/   Presents
    ___    ____        ____                          ___       __          _
   /   |  / __ \      / __ \____ _      _____  _____/   | ____/ /___ ___  (_)___
  / /| | / / / /_____/ /_/ / __ \ | /| / / _ \/ ___/ /| |/ __  / __ `__ \/ / __ \
 / ___ |/ /_/ /_____/ ____/ /_/ / |/ |/ /  __/ /  / ___ / /_/ / / / / / / / / / /
/_/  |_/_____/     /_/    \____/|__/|__/\___/_/  /_/  |_\__,_/_/ /_/ /_/_/_/ /_/
Version: 0.6.0 beta
================ AD-PowerAdmin Tools ================
 1:  Press  '1' Audit AD Admin account Report.
 2:  Press  '2' Run a security audit.
 3:  Press  '3' Force KRBTGT password Update.
 4:  Press  '4' Search for inactive computers report only.
 5:  Press  '5' Search for inactive computers and disable them.
 6:  Press  '6' Search for inactive users accounts.
 7:  Press  '7' Search for inactive users accounts and disable them.
 8:  Press  '8' Run a password audit WITHOUT sending emails to users or scheduling a forced password changes.
 9:  Press  '9' Same as option 8, but send the password audit report to the Admins.
 10: Press  '10' Run a password audit AND send emails to users and schedule forced password changes.
D: Press 'D' Run all daily tasks.
I: Press 'I' To install this script as a scheduled task to run the daily test, checks, and clean-up.
E: Press 'E' To send a test email.
H: Press 'H' To show the help menu.
Q: Press 'Q' to quit.

    ______      __                 ________          ___
   / ____/_  __/ /_  ___  _____   / ____/ /___ _____/ (_)_  _______
  / /   / / / / __ \/ _ \/ ___/  / / __/ / __ `/ __  / / / / / ___/
 / /___/ /_/ / /_/ /  __/ /     / /_/ / / /_/ / /_/ / / /_/ (__  )
 \____/\__, /_.___/\___/_/      \____/_/\__,_/\__,_/_/\__,_/____/
      /____/   Presents
    ___    ____        ____                          ___       __          _
   /   |  / __ \      / __ \____ _      _____  _____/   | ____/ /___ ___  (_)___
  / /| | / / / /_____/ /_/ / __ \ | /| / / _ \/ ___/ /| |/ __  / __ `__ \/ / __ \
 / ___ |/ /_/ /_____/ ____/ /_/ / |/ |/ /  __/ /  / ___ / /_/ / / / / / / / / / /
/_/  |_/_____/     /_/    \____/|__/|__/\___/_/  /_/  |_\__,_/_/ /_/ /_/_/_/ /_/
Version: 0.6.0 beta
================ AD-PowerAdmin Tools ================
 1:  Press  '1' Audit AD Admin account Report.
 2:  Press  '2' Run a security audit.
 3:  Press  '3' Force KRBTGT password Update.
 4:  Press  '4' Search for inactive computers report only.
 5:  Press  '5' Search for inactive computers and disable them.
 6:  Press  '6' Search for inactive users accounts.
 7:  Press  '7' Search for inactive users accounts and disable them.
 8:  Press  '8' Run a password audit WITHOUT sending emails to users or scheduling a forced password changes.
 9:  Press  '9' Same as option 8, but send the password audit report to the Admins.
 10: Press  '10' Run a password audit AND send emails to users and schedule forced password changes.
D: Press 'D' Run all daily tasks.
I: Press 'I' To install this script as a scheduled task to run the daily test, checks, and clean-up.
E: Press 'E' To send a test email.
H: Press 'H' To show the help menu.
Q: Press 'Q' to quit.
**********************
Windows PowerShell transcript end
End time: 20221112083521
**********************
**********************
Windows PowerShell transcript start
Start time: 20221112083523
Username: TDCME\bret.admin
RunAs User: TDCME\bret.admin
Machine: FL-222 (Microsoft Windows NT 10.0.14393.0)
Host Application: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
Process ID: 6416
PSVersion: 5.1.14393.5127
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.14393.5127
BuildVersion: 10.0.14393.5127
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************

    ______      __                 ________          ___
   / ____/_  __/ /_  ___  _____   / ____/ /___ _____/ (_)_  _______
  / /   / / / / __ \/ _ \/ ___/  / / __/ / __ `/ __  / / / / / ___/
 / /___/ /_/ / /_/ /  __/ /     / /_/ / / /_/ / /_/ / / /_/ (__  )
 \____/\__, /_.___/\___/_/      \____/_/\__,_/\__,_/_/\__,_/____/
      /____/   Presents
    ___    ____        ____                          ___       __          _
   /   |  / __ \      / __ \____ _      _____  _____/   | ____/ /___ ___  (_)___
  / /| | / / / /_____/ /_/ / __ \ | /| / / _ \/ ___/ /| |/ __  / __ `__ \/ / __ \
 / ___ |/ /_/ /_____/ ____/ /_/ / |/ |/ /  __/ /  / ___ / /_/ / / / / / / / / / /
/_/  |_/_____/     /_/    \____/|__/|__/\___/_/  /_/  |_\__,_/_/ /_/ /_/_/_/ /_/
Version: 0.6.0 beta
================ AD-PowerAdmin Tools ================
 1:  Press  '1' Audit AD Admin account Report.
 2:  Press  '2' Run a security audit.
 3:  Press  '3' Force KRBTGT password Update.
 4:  Press  '4' Search for inactive computers report only.
 5:  Press  '5' Search for inactive computers and disable them.
 6:  Press  '6' Search for inactive users accounts.
 7:  Press  '7' Search for inactive users accounts and disable them.
 8:  Press  '8' Run a password audit WITHOUT sending emails to users or scheduling a forced password changes.
 9:  Press  '9' Same as option 8, but send the password audit report to the Admins.
 10: Press  '10' Run a password audit AND send emails to users and schedule forced password changes.
D: Press 'D' Run all daily tasks.
I: Press 'I' To install this script as a scheduled task to run the daily test, checks, and clean-up.
E: Press 'E' To send a test email.
H: Press 'H' To show the help menu.
Q: Press 'Q' to quit.
Warrning: The GPO configuration file '\\tdcme.loc\SYSVOL\tdcme.loc\Policies\{6AC1786C-016F-11D2-945F-00C04fB984F9}\Machine\Microsoft\Windows NT\SecEdit\GptTmpl.inf' does not contain the 'SeServiceLogonRight' line.


DisplayName      : Default Domain Controllers Policy
DomainName       : tdcme.loc
Owner            : TDCME\Domain Admins
Id               : 6ac1786c-016f-11d2-945f-00c04fb984f9
GpoStatus        : AllSettingsEnabled
Description      :
CreationTime     : 3/7/2020 8:36:11 AM
ModificationTime : 11/12/2022 8:35:33 AM
UserVersion      : AD Version: 0, SysVol Version: 0
ComputerVersion  : AD Version: 22, SysVol Version: 22
WmiFilter        :

DisplayName      : Default Domain Controllers Policy
DomainName       : tdcme.loc
Owner            : TDCME\Domain Admins
Id               : 6ac1786c-016f-11d2-945f-00c04fb984f9
GpoStatus        : AllSettingsEnabled
Description      :
CreationTime     : 3/7/2020 8:36:11 AM
ModificationTime : 11/12/2022 8:35:33 AM
UserVersion      : AD Version: 0, SysVol Version: 0
ComputerVersion  : AD Version: 23, SysVol Version: 23
WmiFilter        :


    ______      __                 ________          ___
   / ____/_  __/ /_  ___  _____   / ____/ /___ _____/ (_)_  _______
  / /   / / / / __ \/ _ \/ ___/  / / __/ / __ `/ __  / / / / / ___/
 / /___/ /_/ / /_/ /  __/ /     / /_/ / / /_/ / /_/ / / /_/ (__  )
 \____/\__, /_.___/\___/_/      \____/_/\__,_/\__,_/_/\__,_/____/
      /____/   Presents
    ___    ____        ____                          ___       __          _
   /   |  / __ \      / __ \____ _      _____  _____/   | ____/ /___ ___  (_)___
  / /| | / / / /_____/ /_/ / __ \ | /| / / _ \/ ___/ /| |/ __  / __ `__ \/ / __ \
 / ___ |/ /_/ /_____/ ____/ /_/ / |/ |/ /  __/ /  / ___ / /_/ / / / / / / / / / /
/_/  |_/_____/     /_/    \____/|__/|__/\___/_/  /_/  |_\__,_/_/ /_/ /_/_/_/ /_/
Version: 0.6.0 beta
================ AD-PowerAdmin Tools ================
 1:  Press  '1' Audit AD Admin account Report.
 2:  Press  '2' Run a security audit.
 3:  Press  '3' Force KRBTGT password Update.
 4:  Press  '4' Search for inactive computers report only.
 5:  Press  '5' Search for inactive computers and disable them.
 6:  Press  '6' Search for inactive users accounts.
 7:  Press  '7' Search for inactive users accounts and disable them.
 8:  Press  '8' Run a password audit WITHOUT sending emails to users or scheduling a forced password changes.
 9:  Press  '9' Same as option 8, but send the password audit report to the Admins.
 10: Press  '10' Run a password audit AND send emails to users and schedule forced password changes.
D: Press 'D' Run all daily tasks.
I: Press 'I' To install this script as a scheduled task to run the daily test, checks, and clean-up.
E: Press 'E' To send a test email.
H: Press 'H' To show the help menu.
Q: Press 'Q' to quit.
**********************
Windows PowerShell transcript end
End time: 20221112083923
**********************
