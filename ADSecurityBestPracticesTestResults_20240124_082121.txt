**********************
Windows PowerShell transcript start
Start time: 20240124082121
Username: TDCME\bret.admin
RunAs User: TDCME\bret.admin
Machine: FL-222 (Microsoft Windows NT 10.0.14393.0)
Host Application: C:\Windows\system32\wsmprovhost.exe -Embedding
Process ID: 3596
PSVersion: 5.1.14393.5582
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.14393.5582
BuildVersion: 10.0.14393.5582
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
Transcript started, output file is L:\\Data\\My Work\\PowerShell Scripts\\AD-PowerAdmin\ADSecurityBestPracticesTestResults_20240124_082121.txt
Testing the AD Password Policy
The Password Policy setting 'ComplexityEnabled' is set to True. Good!
The Password Policy setting 'LockoutDuration' is set to 00:30:00. Good!
The Password Policy setting 'LockoutObservationWindow' is set to 00:30:00. Good!
The Password Policy setting 'LockoutThreshold' is set to 0. Good!
The Password Policy setting 'MaxPasswordAge' is set to 42.00:00:00. Good!
The Password Policy setting 'MaxPasswordAge' recommendations have changed recently(2022).
    We no longer suggest forcing users to update their passwords every 90-days.
    If you want to know more read here: https://cybergladius.com/password-policy-best-practices-in-2023/
The Password Policy setting 'MinPasswordAge' is set to 1.00:00:00. Good!
The Password Policy setting 'MinPasswordLength' is set to 7. This should be set to 14.
The Password Policy setting 'PasswordHistoryCount' is set to 24. Good!
The Password Policy setting 'ReversibleEncryptionEnabled' is set to False. Good!
======================================================================================
The following AD Objects have DCSync permissions and could be used to perform a DCSync Attack.
Some or all of these AD Objects with DCSync permissions may be completely expected, depend on your environment.
The number user objects with this right that were found: 20

SamAccountName RightObjectName                            InheritedRightFrom       AceApplicableTo
-------------- ---------------                            ------------------       ---------------
Administrator  All                                        BUILTIN\Administrators   DC=tdcme,DC=loc
ADPowerAdmMSA$ All                                        BUILTIN\Administrators   DC=tdcme,DC=loc
test.admin     All                                        BUILTIN\Administrators   DC=tdcme,DC=loc
bret.admin     All                                        BUILTIN\Administrators   DC=tdcme,DC=loc
bret.admin     All                                        TDCME\Domain Admins      DC=tdcme,DC=loc
test.admin     All                                        TDCME\Domain Admins      DC=tdcme,DC=loc
ADPowerAdmMSA$ All                                        TDCME\Domain Admins      DC=tdcme,DC=loc
Administrator  DS-Replication-Get-Changes-In-Filtered-Set BUILTIN\Administrators   DC=tdcme,DC=loc
ADPowerAdmMSA$ DS-Replication-Get-Changes-In-Filtered-Set BUILTIN\Administrators   DC=tdcme,DC=loc
test.admin     DS-Replication-Get-Changes-In-Filtered-Set BUILTIN\Administrators   DC=tdcme,DC=loc
bret.admin     DS-Replication-Get-Changes-In-Filtered-Set BUILTIN\Administrators   DC=tdcme,DC=loc
Administrator  DS-Replication-Get-Changes-All             BUILTIN\Administrators   DC=tdcme,DC=loc
ADPowerAdmMSA$ DS-Replication-Get-Changes-All             BUILTIN\Administrators   DC=tdcme,DC=loc
test.admin     DS-Replication-Get-Changes-All             BUILTIN\Administrators   DC=tdcme,DC=loc
bret.admin     DS-Replication-Get-Changes-All             BUILTIN\Administrators   DC=tdcme,DC=loc
Administrator  DS-Replication-Get-Changes                 BUILTIN\Administrators   DC=tdcme,DC=loc
ADPowerAdmMSA$ DS-Replication-Get-Changes                 BUILTIN\Administrators   DC=tdcme,DC=loc
test.admin     DS-Replication-Get-Changes                 BUILTIN\Administrators   DC=tdcme,DC=loc
bret.admin     DS-Replication-Get-Changes                 BUILTIN\Administrators   DC=tdcme,DC=loc
FL-222$        DS-Replication-Get-Changes-All             TDCME\Domain Controllers DC=tdcme,DC=loc


======================================================================================
The following AD Objects have high risk permissions.
The number user objects with this right that were found: 7

SamAccountName RightObjectName InheritedRightFrom     AceApplicableTo
-------------- --------------- ------------------     ---------------
Administrator  All             BUILTIN\Administrators DC=tdcme,DC=loc
ADPowerAdmMSA$ All             BUILTIN\Administrators DC=tdcme,DC=loc
test.admin     All             BUILTIN\Administrators DC=tdcme,DC=loc
bret.admin     All             BUILTIN\Administrators DC=tdcme,DC=loc
bret.admin     All             TDCME\Domain Admins    DC=tdcme,DC=loc
test.admin     All             TDCME\Domain Admins    DC=tdcme,DC=loc
ADPowerAdmMSA$ All             TDCME\Domain Admins    DC=tdcme,DC=loc


======================================================================================
Testing for Unprivileged accounts with adminCount=1
No AD Users were found with attributes 'adminCount' = 1.
======================================================================================
Testing for Users and computers with non-default Primary Group IDs
No AD Users were found with a non-default Primary Group ID.
======================================================================================
Testing for Disabled accounts with Group Membership other than 'Domain Users' group
The disabled AD account 'Test Admin' is a member of the following groups:
Domain Admins
======================================================================================
Testing for Computers in the default 'Computers' folder
Systems in the default 'Computers' folder are likely missing GPOs since they are not organized into a specific OU; thus, security holes.
No AD Computers were found in the default 'Computers' folder.
======================================================================================
Testing for inactive users
Error: The User OU specified in the DisabledOULocal(OU=Disabled.Users,OU=Users,DC=EXAMPLE,DC=COM) does not exist in the AD.
       Please update your 'AD-PowerAdmin_settings.ps1' file with the details that match your environment.
======================================================================================
Testing for inactive computers
Error: The Computer OU specified in the SearchOUbase parameter does not exist in the Active Directory Domain.
       Please update your 'AD-PowerAdmin_settings.ps1' file with the details that match your environment.
Error: The Computer OU specified in the SearchOUbase parameter does not exist in the Active Directory Domain.
       Please update your 'AD-PowerAdmin_settings.ps1' file with the details that match your environment.
======================================================================================
Running a password audit
No OU was provided, so all users will be checked.
Warning: The pwned-passwords-ntlm-ordered-by-hash-v8.txt file does not exist. The pwned-passwords-ntlm-ordered-by-hash-v8.txt file will not be used.
Warning: The weak-passwords.txt file does not exist. The weak-passwords.txt file will not be used.

Active Directory Password Quality Report
----------------------------------------

Passwords of these accounts are stored using reversible encryption:
  
LM hashes of passwords of these accounts are present:
  
These accounts have no password set:
  
Passwords of these accounts have been found in the dictionary:
  
These groups of accounts have the same passwords:
  
These computer accounts have default passwords:
  
Kerberos AES keys are missing from these accounts:
  
Kerberos pre-authentication is not required for these accounts:
  
Only DES encryption is allowed to be used with these accounts:
  
These accounts are susceptible to the Kerberoasting attack:
  
These administrative accounts are allowed to be delegated to a service:
  TDCME\Administrator
  TDCME\ADPowerAdmMSA$
  TDCME\AIR-250$
  TDCME\AIR-251$
  TDCME\bret.admin
  
Passwords of these accounts will never expire:
  TDCME\bret
  TDCME\bret.admin
  TDCME\FREIGHTLINER-32$
  TDCME\Media_User
  TDCME\torrent
  
These accounts are not required to have a password:
  
These accounts that require smart card authentication have a password:
**********************
Windows PowerShell transcript end
End time: 20240124082134
**********************
